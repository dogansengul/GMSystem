#!/usr/bin/env node
const url = require('url');
const inquirer = require('inquirer');
const spdf = require('./lib');
const copy = require('copy-paste').copy;

inquirer.prompt([
    {name: 'password', message: 'Master Password', type: 'password', validate: (input) => input.trim().length > 0},
    {name: 'salt', message: 'Master Salt', type: 'password', validate: (input) => input.trim().length > 0},
    {name: 'url', message: 'Site URL', type: 'input', validate: (input) => input.trim().length > 0},
    {name: 'username', message: 'Site Username', type: 'input', validate: (input) => input.trim().length > 0},
])
    .then(input => spdf(input.password, input.salt, [url.parse(input.url).hostname, input.username.trim().toLowerCase()], 12, {}))
    .then(result => {
        copy(result, () => {
            console.log('Password was copied to the clipboard');
        });
    })
    .catch(err => console.error(err));